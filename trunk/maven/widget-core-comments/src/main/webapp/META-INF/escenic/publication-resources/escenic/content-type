<?xml version="1.0" encoding="UTF-8"?>
<!--
 * File           : $Header: //depot/escenic/widget-framework/trunk/widget-framework-core/src/main/webapp/META-INF/escenic/publication-resources/escenic/content-type#2 $
 * Last edited by : $Author: shah $ $Date: 2010/05/10 $
 * Version        : $Revision: #2 $
 *
 * Copyright (C) 2009 Escenic AS.
 * All Rights Reserved.  No use, copying or distribution of this
 * work may be made except in accordance with a valid license
 * agreement from Escenic AS.  This notice must be included on
 * all copies, modifications and derivatives of this work.
-->

<content-types xmlns="http://xmlns.escenic.com/2008/content-type"
               xmlns:ui="http://xmlns.escenic.com/2008/interface-hints"
               xmlns:geocode="http://xmlns.escenic.com/2009/studio/plugin/geocode"
               xmlns:rep="http://xmlns.escenic.com/2009/representations"
							 xmlns:doc="http://xmlns.vizrt.com/2010/documentation"
               version="4">
  <!-- define comments widget field groups -->
  <!-- general fields -->
  <field-group name="comments-general-fields">
    <field name="view" type="enumeration">
      <ui:label>View</ui:label>
      <ui:description>View used to render the widget</ui:description>
      <enumeration value="flat">
        <ui:label>Flat</ui:label>
				<doc:description xmlns="http://www.w3.org/1999/xhtml" >
					<p>Select this view if you want all comments to be displayed on the same level, whether they are 
            comments on the original article or responses to other comments.</p>
				</doc:description>
      </enumeration>
      <enumeration value="threaded">
        <ui:label>Threaded</ui:label>
				<doc:description xmlns="http://www.w3.org/1999/xhtml" >
					<p>Select this view if you comments to be displayed in a hierarchical, <em>threaded</em> structure that allows
            readers to distinguish between comments on the original article and responses to other comments.</p>
				</doc:description>
      </enumeration>
      <ui:value-if-unset>flat</ui:value-if-unset>
    </field>
  </field-group>
  <!-- flat view fields -->
  <field-group name="comments-flat-fields">
    <field name="anonymousFlat" type="boolean">
      <ui:label>Anonymous comments</ui:label>
      <ui:description>Anonymous comments can be made by users who aren't logged in to the system, or by logged in users
        who wish to remain anonymous.
      </ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want to allow users who are not logged in to make comments.</p>
			</doc:description>
      <ui:boolean-label value="true">Allow anonymous comments</ui:boolean-label>
      <ui:boolean-label value="false">Don't allow anonymous comments</ui:boolean-label>
      <ui:value-if-unset>true</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="moderationFlat" type="boolean">
      <ui:label>Comment moderation</ui:label>
      <ui:boolean-label value="true">Comments will be moderated</ui:boolean-label>
      <ui:boolean-label value="false">Comments will be unmoderated</ui:boolean-label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want a moderator to control which comments get published. If you check this
          option then all comments will be submitted for moderation, and will not be published unless they are
          approved by the moderator.</p>
			</doc:description>
      <ui:description>When a comments are moderated, new postings must be approved by a moderator.</ui:description>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="complaintsFlat" type="boolean">
      <ui:label>Comment complaints</ui:label>
      <ui:description>Complaints allow visitors to notify moderators of inappropriate behaviour</ui:description>
      <ui:boolean-label value="true">Allow complaints against comments</ui:boolean-label>
      <ui:boolean-label value="false">Don't allow complaints against comments</ui:boolean-label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want to allow visitors to make complaints about published comments. A "complaint"
          button or link will then be displayed next to each published comment.</p>
			</doc:description>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="commentsPerPageFlat" type="number">
      <ui:label>Number of comments per page</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the number of comments you want to appear on each page.</p>
			</doc:description>
      <constraints>
        <minimum>1</minimum>
        <maximum>10</maximum>
      </constraints>
      <format>##</format>
      <ui:value-if-unset>5</ui:value-if-unset>
    </field>
    <field name="numberOfPageLinksFlat" type="number">
      <ui:label>Number of page links in the pagination</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the maximum number of page links you want to appear at the bottom of the page 
          if there is more than one page of comments.</p>
			</doc:description>
      <constraints>
        <minimum>1</minimum>
        <maximum>10</maximum>
      </constraints>
      <format>##</format>
      <ui:value-if-unset>5</ui:value-if-unset>
    </field>
  </field-group>
  <!-- threaded view fields -->
  <field-group name="comments-threaded-fields">
    <field name="anonymousThreaded" type="boolean">
      <ui:label>Allow anonymous comments</ui:label>
      <ui:description>Anonymous comments can be made by users who aren't logged in to the system, or by logged in users
        who wish to remain anonymous.
      </ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want to allow users who are not logged in to make comments.</p>
			</doc:description>
      <ui:boolean-label value="true">Allow anonymous comments</ui:boolean-label>
      <ui:boolean-label value="false">Don't allow anonymous comments</ui:boolean-label>
      <ui:value-if-unset>true</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="moderationThreaded" type="boolean">
      <ui:label>Comment moderation</ui:label>
      <ui:boolean-label value="true">Comments will be moderated</ui:boolean-label>
      <ui:boolean-label value="false">Comments will be unmoderated</ui:boolean-label>
      <ui:description>When a comments are moderated, new postings must be approved by a moderator.</ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want a moderator to control which comments get published. If you check this
          option then all comments will be submitted for moderation, and will not be published unless they are
          approved by the moderator.</p>
			</doc:description>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="complaintsThreaded" type="boolean">
      <ui:label>Allow complaint against a comment</ui:label>
      <ui:description>Complaints allow visitors to notify moderators of inappropriate behaviour</ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want to allow visitors to make complaints about published comments. A "complaint"
          button or link will then be displayed next to each published comment.</p>
			</doc:description>
      <ui:boolean-label value="true">Allow complaints against comments</ui:boolean-label>
      <ui:boolean-label value="false">Don't allow complaints against comments</ui:boolean-label>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="threadDepth" type="number">
      <ui:label>Maximum depth of the thread</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify how many levels of conversation you want to be displayed by default. Specifying the minimum value
          of 1 is the means that only top level comments on the original article are displayed at first: visitors
          must expand a comment in order to see answers to it. Specifying 2 means that both top level comments
          and answers to those comments are immediately visible, but further levels require expansion, and so on.</p>
			</doc:description>
      <constraints>
        <minimum>1</minimum>
        <maximum>5</maximum>
      </constraints>
      <format>#</format>
      <ui:value-if-unset>3</ui:value-if-unset>
    </field>
    <field name="commentsPerPageThreaded" type="number">
      <ui:label>Number of comments per page</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the number of comments you want to appear on each page.</p>
			</doc:description>
      <constraints>
        <minimum>1</minimum>
        <maximum>10</maximum>
      </constraints>
      <format>##</format>
      <ui:value-if-unset>5</ui:value-if-unset>
    </field>
    <field name="numberOfPageLinksThreaded" type="number">
      <ui:label>Number of page links in the pagination</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the maximum number of page links you want to appear at the bottom of the page 
          if there is more than one page of comments.</p>
			</doc:description>
      <constraints>
        <minimum>1</minimum>
        <maximum>10</maximum>
      </constraints>
      <format>##</format>
      <ui:value-if-unset>5</ui:value-if-unset>
    </field>
  </field-group>
  <!-- advanced fields-->
  <field-group name="comments-advanced-fields">
    <field name="titleLength" type="number">
      <ui:label>Maximum number of characters in a comment title</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the maximum title length you want to allow (assuming you have checked the <em>Show comment title</em>
          option). The generated comments form will not allow visitors to enter titles longer than the limit you 
          specify.</p>
			</doc:description>
      <constraints>
        <minimum>10</minimum>
        <maximum>500</maximum>
      </constraints>
      <format>###</format>
      <ui:value-if-unset>100</ui:value-if-unset>
    </field>
    <field name="bodyLength" type="number">
      <ui:label>Maximum number of characters in a comment body</ui:label>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Specify the maximum comment length you want to allow. The generated comments form will not allow
          visitors to enter comments longer than the limit you specify.</p>
			</doc:description>
      <constraints>
        <minimum>100</minimum>
        <maximum>5000</maximum>
      </constraints>
      <format>####</format>
      <ui:value-if-unset>1000</ui:value-if-unset>
    </field>
    <field name="showTitle" type="boolean">
      <ui:label>Show comment title</ui:label>
      <ui:description>Option to configure whether comment title will be displayed or not</ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want comments to have titles.</p>
			</doc:description>
      <ui:boolean-label value="true">Require a comment title</ui:boolean-label>
      <ui:boolean-label value="false">Don't require a comment title</ui:boolean-label>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
    <field name="captcha" type="boolean">
      <ui:label>Show CAPTCHA</ui:label>
      <ui:description>A CAPTCHA is a test that checks that a comment comes from a human being and not a robot.
      </ui:description>
			<doc:description xmlns="http://www.w3.org/1999/xhtml" >
				<p>Check this option if you want anonymous comments to be protected by a CAPTCHA. CAPTCHA is a
        technique for ensuring that comments are submitted by real persons rather than software processes: the
        commenter is usually required to enter the characters displayed in a distorted image that is difficult 
        for software to interpret.</p>
			</doc:description>
      <ui:boolean-label value="true">Require a CAPTCHA for anonymous comment</ui:boolean-label>
      <ui:boolean-label value="false">Don't require a CAPTCHA for anonymous comment</ui:boolean-label>
      <ui:value-if-unset>false</ui:value-if-unset>
      <constraints>
	      <required>true</required>
	    </constraints>
    </field>
  </field-group>

  <!-- content type for comments widget -->
  <content-type name="widget_comments">
    <ui:icon>generic</ui:icon>
    <ui:label>Comments Widget</ui:label>
    <ui:description>A widget that displays existing article comments
      and allows reader/user to post a new comment
    </ui:description>
		<doc:description xmlns="http://www.w3.org/1999/xhtml" >
			<p>Supports commenting on published content. The widget displays comments submitted by site visitors
        and provides the user interface components needed for:</p>

      <ul>
        <li>Posting new comments on an article</li>
        <li>Replying to posted comments</li>
        <li>Submitting complaints about posted comments</li>
      </ul>

			<p>The Comments widget is very flexible. It supports:</p>

      <ul>
        <li>Both a flat comment structure (in which only comments on the original article are supported) 
          and a threaded structure (in which visitors are also allowed to directly reply to comments).</li>
        <li>Pagination of comments, with a user-definable page size.</li>
        <li>Optional moderation of comments.</li>
        <li>Optional anonymous comments.</li>
        <li>Optional CAPTCHA tests to prevent the automated submission of comments.</li>
      </ul>
      <p>The Comments widget depends on the Escenic Content Engine's Forum plug-in: it will not work unless
        this plug-in is installed. In addition, it has the following configuration requirements:</p>

      <ul>
        <li>Your publication's <code>content-types</code> resource must contain one "forum" content type
        and one "posting" content type.</li>
        <li>Your publication must have two active forums: one with moderation enabled, and the other
          with moderation disabled.</li>
        <li>
           <p>You must set the following section parameters in the root section of your publication:</p>
           <pre>comments.unmoderated.forumId = <i>unmoderated-forum-id</i>
comments.moderated.forumId = <i>moderated-forum-id</i></pre>
           <p>where <i>unmoderated-forum-id</i> and <i>moderated-forum-id</i> are the IDs of the 
             forums you have set up.</p>
        </li>
      </ul>
      <p> For information about Forum content types, see the <em>Escenic Content Engine Forum Plug-in Guide</em>.
        For a description of how to set section parameters, see the <em>Escenic Content Engine Publication
        Administrator Guide</em>.</p>
		</doc:description>
    <ui:title-field>title</ui:title-field>

    <panel name="general">
      <ui:label>General</ui:label>
      <ui:description>The general fields for configuring the comments widget</ui:description>
      <ref-field-group name="basic-widget-fields"/>
      <ref-field-group name="comments-general-fields"/>
    </panel>

    <panel name="flat">
      <ui:label>Flat</ui:label>
      <ui:description>The fields related to the flat view</ui:description>
      <ref-field-group name="comments-flat-fields"/>
    </panel>

    <panel name="threaded">
      <ui:label>Threaded</ui:label>
      <ui:description>The fields related to the threaded view</ui:description>
      <ref-field-group name="comments-threaded-fields"/>
    </panel>

    <panel name="advanced">
      <ui:label>Advanced</ui:label>
      <ui:description>The advanced configuration fields</ui:description>
      <ref-field-group name="basic-widget-style-fields"/>
      <ref-field-group name="comments-advanced-fields"/>
      <ref-field-group name="noPrint-fields"/>
    </panel>

    <panel name="caching">
      <ui:label>Caching</ui:label>
      <ui:description>Allows you to control web cache settings</ui:description>
      <ref-field-group name="caching-basic-fields"/>
      <ref-field-group name="cache-control-public-fields"/>
    </panel>

    <summary>
      <ui:label>Summary</ui:label>
      <field type="basic" mime-type="text/plain" name="title">
        <ui:label>Title</ui:label>
      </field>
    </summary>
  </content-type>
</content-types>
