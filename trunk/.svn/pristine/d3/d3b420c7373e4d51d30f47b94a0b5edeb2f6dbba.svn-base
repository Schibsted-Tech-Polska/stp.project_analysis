<?xml version="1.0" encoding="UTF-8" ?>
<!--
 * File           : $Header: //depot/escenic/widget-framework/branches/1.4/widget-framework-community/src/main/webapp/WEB-INF/struts-config-community.xml#1 $
 * Last edited by : $Author: shah $ $Date: 2010/10/18 $
 * Version        : $Revision: #1 $
 *
 * Copyright (C) 2009 Escenic AS.
 * All Rights Reserved.  No use, copying or distribution of this
 * work may be made except in accordance with a valid license
 * agreement from Escenic AS.  This notice must be included on
 * all copies, modifications and derivatives of this work.
-->

<!DOCTYPE struts-config PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
    "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<struts-config>

  <form-beans>
    <form-bean name="signinForm" type="com.escenic.community.forms.SSOSignInForm" />
    <form-bean name="userProfileForm" type="com.ndc.usercontent.struts.actions.forms.UserProfileForm" />
    <form-bean name="passwordForm" type="com.ndc.usercontent.struts.actions.forms.PasswordForm" />
    <form-bean name="changePasswordForm" type="com.escenic.profile.presentation.struts.ChangePasswordForm"/>
    <form-bean name="articleForm" type="com.ndc.usercontent.struts.actions.forms.ArticleForm" />
    <form-bean name="uploadForm" type="com.ndc.usercontent.struts.actions.forms.UploadForm" />
    <form-bean name="qualificationForm" type="com.ndc.qualification.struts.actions.forms.QualificationForm" />
    <form-bean name="bulkDeleteForm" type="com.escenic.framework.community.struts.forms.BulkDeleteActionForm" />
    <form-bean name="threadForm" type="com.escenic.forum.struts.presentation.CommentForm" />
  </form-beans>

  <action-mappings>
    <action path="/community/login"
            name="signinForm"
            scope="request"
            validate="true"
            input="/index.jsp"
            type="com.escenic.community.actions.SSOLogin">
      <forward name="success" path="/community/loginForward.do" />
    </action>

    <action path="/community/loginForward"
            scope="request"
            name="signinForm"
            validate="true"
            input="/index.jsp"
            parameter="userProfile"
            type="com.ndc.usercontent.struts.actions.login.Login">
      <forward name="error" path="/" />
    </action>

    <action path="/community/logoff"
            name="signinForm"
            scope="request"
            validate="false"
            type="com.ndc.usercontent.struts.actions.login.Logoff">
      <forward name="success" path="/community/logoffForward.do" />
    </action>

    <action path="/community/logoffForward"
            name="signinForm"
            scope="request"
            validate="false"
            type="com.escenic.profile.presentation.struts.LogoffAction">
      <forward name="success" path="/" redirect="true" />
    </action>

    <action path="/community/addUserProfile"
            name="userProfileForm"
            scope="request"
            parameter="userProfile"
            type="com.ndc.usercontent.struts.actions.save.SaveUserProfile">
    </action>

    <action path="/community/editUserProfile"
            name="userProfileForm"
            scope="request"
            parameter="userProfile"
            type="com.ndc.usercontent.struts.actions.save.SaveUserProfile">
    </action>

    <action path="/community/loadUserProfileForm"
            name="userProfileForm"
            scope="request"
            parameter="userProfile"
            type="com.ndc.usercontent.struts.actions.load.LoadArticle">
    </action>

    <action path="/community/resetPassword"
            type="com.ndc.usercontent.struts.actions.login.ResetPassword"
            name="passwordForm"
            input="/index.jsp"
            validate="true">
    </action>

    <action path="/community/changePassword"
            type="com.escenic.profile.presentation.struts.SetPasswordAction"
            name="changePasswordForm"
            scope="request"
            input="/index.jsp"
            validate="true">
    </action>

    <action path="/community/deleteUserProfile"
            name="articleForm"
            scope="request"
            type="com.ndc.usercontent.struts.actions.delete.DeleteUserProfile">
    </action>

    <action path="/community/jCaptcha"
            type="com.octo.captcha.module.struts.image.RenderImageCaptchaAction" />

    <action path="/community/loadStoryForm"
            name="articleForm"
            scope="request"
            parameter="news"
            type="com.ndc.usercontent.struts.actions.load.LoadArticle">
    </action>

    <action path="/community/bulkDeleteArticles"
            name="bulkDeleteForm"
            scope="request"
            type="com.escenic.framework.community.struts.actions.BulkDeleteAction">
      <!-- Error and Success url are set in template -->
    </action>

    <action path="/community/loadBlogForm"
            name="articleForm"
            scope="request"
            parameter="blogPost"
            type="com.ndc.usercontent.struts.actions.load.LoadArticle">
    </action>

    <action path="/community/addBlogPost"
            name="articleForm"
            scope="request"
            parameter="articleType=blogPost;allowSetPublishDate=true;allowSetActivateDate=true;allowSetExpireDate=true"
            type="com.ndc.usercontent.struts.actions.save.SaveArticle">
      <forward name="success" path="/community/loadBlogForm.do"/>
      <forward name="error" path="/community/loadBlogForm.do"/>
    </action>

    <action path="/community/editBlogPost"
            name="articleForm"
            scope="request"
            type="com.ndc.usercontent.struts.actions.save.SaveArticle">
      <forward name="success" path="/community/loadBlogForm.do"/>
      <forward name="error" path="/community/loadBlogForm.do"/>
    </action>

    <action path="/community/deleteBlogPost"
            name="articleForm"
            scope="request"
            type="com.ndc.usercontent.struts.actions.delete.DeleteArticle">
    </action>

    <action path="/community/loadPictureForm"
            name="articleForm"
            scope="request"
            parameter="picture"
            type="com.ndc.usercontent.struts.actions.load.LoadArticle">
    </action>

    <action path="/community/loadAvatarForm"
            name="articleForm"
            scope="request"
            parameter="avatar"
            type="com.ndc.usercontent.struts.actions.load.LoadArticle">
    </action>

    <action path="/community/addPicture"
            name="uploadForm"
            scope="request"
            parameter="articleType=picture"
            type="com.ndc.usercontent.struts.actions.upload.MediaContentUpload">
      <!-- Error and Success url are set in template -->
      <forward name="success" path="/community/loadPictureForm.do"/>
      <forward name="error" path="/community/loadPictureForm.do"/>
    </action>

    <action path="/community/editPicture"
            name="articleForm"
            scope="request"
            type="com.ndc.usercontent.struts.actions.save.SaveArticle">
      <forward name="success" path="/community/loadPictureForm.do"/>
      <forward name="error" path="/community/loadPictureForm.do"/>
    </action>

    <action path="/community/deleteContent"
            name="articleForm"
            scope="request"
            type="com.ndc.usercontent.struts.actions.delete.DeleteArticle">
      <!-- Error and Success url are set in template -->
    </action>

    <action path="/SubmitFlagging"
            name="qualificationForm"
            scope="request"
            type="com.ndc.qualification.struts.actions.SubmitFlagging">
      <forward name="error" path="/"/>
      <forward name="success" path="/"/>
    </action>

    <action path="/SubmitStarRating"
            name="qualificationForm"
            scope="request"
            type="com.ndc.qualification.struts.actions.SubmitStarRating">
      <forward name="error" path="/"/>
      <forward name="success" path="/"/>
    </action>

    <action path="/community/addProfilePicture"
            name="uploadForm"
            scope="request"
            parameter="articleType=avatar"
            type="com.escenic.framework.community.struts.actions.ProfilePictureUpload">
      <!-- Error and Success url are set in template -->
      <forward name="success" path="/community/loadAvatarForm.do"/>
      <forward name="error" path="/community/loadAvatarForm.do"/>
    </action>

    <!-- action related to forum widget (dependent on community engine)-->
    <action path="/community/addThread"
            type="com.escenic.forum.struts.presentation.CommunityInsertPostingAction"
            name="threadForm"
            input="/template/common.jsp"
            validate="false"
            scope="request">
      <forward name="target" path="/"/>
    </action>

  </action-mappings>

  <controller processorClass="com.escenic.tools.struts.RequestProcessor" />
  <!-- Validation resource messages  -->
  <message-resources parameter="com.ndc.usercontent.ValidationMessages" key="Validation" null="false" />

  <plug-in className="com.octo.captcha.module.struts.CaptchaServicePlugin"/>
</struts-config>
